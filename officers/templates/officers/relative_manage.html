{% load static %}
{% load static tailwind_tags %}
{% tailwind_css %}

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport"
              content="width=device-width, initial-scale=1.0" />
        <title>{{ officer.birth_name }} - Thân nhân</title>

        <!-- Link to local Font Awesome CSS -->
        <link rel="stylesheet"
              href="{% static 'fonts/font-awesome/css/all.min.css' %}" />

        <!-- Link to compiled Tailwind CSS -->
        <link rel="stylesheet"
              href="{% static 'css/dist/styles.css' %}" />

        <script>
            function confirmDelete() {
                return confirm('Are you sure you want to delete this?');
            }
        </script>
    </head>
    <body class="bg-blue-100">
        <div class="flex">
            <nav class="w-64 h-screen bg-sky-600 px-4 py-6 flex flex-col space-y-2 fixed left-0 top-0 overflow-y-auto">
                <a href="{% url 'officer_list' %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold">
                    <i class="fas fa-home"></i>
                    <span>Trang chủ</span>
                </a>
                <a href="{% url 'officer_detail' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold">
                    <i class="fas fa-info-circle"></i>
                    <span>Thông tin chung</span>
                </a>
                <a href="{% url 'url_title_view' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold">
                    <i class="fas fa-user-tie"></i>
                    <span>Chức danh</span>
                </a>
                <a href="{% url 'url_position_plan' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold">
                    <i class="fas fa-arrow-up-short-wide"></i>
                    <span>Quy hoạch</span>
                </a>
                <a href="{% url 'url_learning_path' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Đào tạo</span>
                </a>
                <a href="{% url 'url_work_process' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold">
                    <i class="fas fa-business-time"></i>
                    <span>Quá trình công tác</span>
                </a>
                <a href="{% url 'url_salary_process' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold text-white">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <span>Quá trình lương</span>
                </a>
                <a href="{% url 'url_laudatory' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold text-white">
                    <i class="fas fa-medal"></i>
                    <span>Khen thưởng</span>
                </a>
                <a href="{% url 'url_discipline' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold text-white">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Kỷ luật</span>
                </a>
                <a href="{% url 'url_relative' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg bg-white text-black font-semibold">
                    <i class="fas fa-users"></i>
                    <span>Thân nhân</span>
                </a>
                <a href="{% url 'url_abroad' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold text-white">
                    <i class="fas fa-plane-departure"></i>
                    <span>Ra nước ngoài</span>
                </a>
                <a href="{% url 'url_army_join_history' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold text-white">
                    <i class="fas fa-person-military-rifle"></i>
                    <span>Tham gia quân đội</span>
                </a>
                <a href="{% url 'url_health' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold text-white">
                    <i class="fas fa-heartbeat"></i>
                    <span>Sức khoẻ</span>
                </a>
                <a href="{% url 'url_image' officer.pk %}"
                   class="flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-sky-500 transition-colors duration-200 font-semibold text-white">
                    <i class="fas fa-image"></i>
                    <span>Ảnh</span>
                </a>
            </nav>
            
            <main class="flex-1 ml-64 p-8 h-screen overflow-y-auto">
                <h1 class="text-4xl text-center">
                    Thông tin thân nhân: <strong class="ml-3">{{ officer.birth_name }}</strong>
                </h1>

                <div class="flex justify-end mb-7 mt-10">
                    <!-- Create New Relative Button -->
                    <a href="{% url 'url_relative_create' officer.pk %}">
                        <button class="btn px-4 py-2 rounded-lg shadow-inner drop-shadow-lg inline-flex items-center text-lg z-10 bg-blue-600 hover:bg-blue-700 text-white">
                            <i class="fa-solid fa-folder-plus"></i>
                            <span class="mr-2">Thêm mới</span>
                        </button>
                    </a>
                </div>
                <div>
                    <div class="rounded-lg shadow-md overflow-hidden">
                        <table class="table-auto border-collapse w-full text-center">
                            <thead>
                                <tr class="bg-sky-600 text-white text-xl">
                                    <th class="py-2 px-4">Quan hệ</th>
                                    <th class="py-2 px-4 text-left">Họ và tên</th>
                                    <th class="py-2 px-4">Năm sinh</th>
                                    <th class="py-2 px-4">Nghề nghiệp</th>
                                    <th class="py-2 pl-28 text-left">Chỗ ở hiện nay</th>
                                    <th class="py-2 px-4"></th>
                                </tr>
                            </thead>
                            <tbody>

                                {% for relative in relatives %}
                                    <tr class="border-t border-gray-300 bg-gray-100 text-lg">
                                        <td class="py-2 pl-4">{{ relative.relationship }}</td>
                                        <td class="py-2 px-4 text-left">{{ relative.name }}</td>
                                        <td class="py-2 px-4">{{ relative.birth_year }}</td>
                                        <td class="py-2 px-4">{{ relative.job }}</td>
                                        <td class="py-2 pl-10 text-left">{{ relative.current_residence }}</td>
                                        <td class="py-2 px-2">
                                            <div class="flex items-center space-x-7">
                                                <!-- Update Button -->
                                                <div class="flex-none tooltip tooltip-top"
                                                    data-tip="Cập nhật">
                                                    <a href="{% url 'url_relative_update' officer.pk relative.id %}">
                                                        <button class="transform motion-safe:hover:scale-110 text-blue-600">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                    </a>
                                                </div>

                                                <!-- Delete Button with confirmation -->
                                                <div class="flex-none tooltip tooltip-top"
                                                    data-tip="Xoá">
                                                    <form method="POST"
                                                        action="{% url 'url_relative_delete' officer.pk relative.id %}"
                                                        onsubmit="return confirmDelete();">
                                                        {% csrf_token %}
                                                        <button type="submit"
                                                                class="transform motion-safe:hover:scale-110 text-red-600">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}

                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Create or Update Relative Form -->

                {% if form %}
                    <dialog class="modal"
                            id="modal">
                        <div class="modal-box">
                            <h1 class="text-xl text-center font-semibold mb-7 ml-2">

                                {% if edit_relative_id %}
                                    Cập nhật thông tin
                                {% else %}
                                    Thêm mới thông tin
                                {% endif %}

                            </h1>
                            <form method="dialog">
                                <a href="{% url 'url_relative' officer.pk %}"
                                   class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 mr-2 mt-4">
                                    <img src="{% static 'src/close.png' %}"
                                         alt="Close Form"
                                         class="w-5 h-5" />
                                </a>
                            </form>

                            <form method="POST">
                                {% csrf_token %}


                                <label for="relationship"
                                       class="font-semibold ml-7">
                                    Quan hệ:
                                </label>
                                <div class="form-group mt-3 mx-5">{{ form.relationship }}</div>

                                <label for="name"
                                       class="font-semibold ml-7">
                                    Họ và tên:
                                </label>
                                <div class="form-group mt-3 mx-5">{{ form.name }}</div>

                                <label for="birth_year"
                                       class="font-semibold ml-7">
                                    Năm sinh:
                                </label>
                                <div class="form-group mt-3 mx-5">{{ form.birth_year }}</div>

                                <label for="job"
                                       class="font-semibold ml-7">
                                    Nghề nghiệp:
                                </label>
                                <div class="form-group mt-3 mx-5">{{ form.job }}</div>

                                <label for="current_residence"
                                       class="font-semibold ml-7">
                                    Chỗ ở hiện nay:
                                </label>
                                <div class="form-group mt-3 mx-5">{{ form.current_residence }}</div>

                                <div class="modal-action">
                                    <button type="submit"
                                            class="btn mr-3 rounded-lg">
                                        Lưu
                                    </button>
                                </div>
                            </form>
                        </div>
                        <form method="dialog"
                              class="modal-backdrop">
                            <a href="{% url 'url_relative' officer.pk %}">close</a>
                        </form>
                    </dialog>
                {% endif %}


                <script>
                    // Automatically show the modal when the page loads
                    document.addEventListener("DOMContentLoaded", function() {
                        document.getElementById('modal').showModal();
                    });
                </script>

            </main>
        </div>
    </body>
</html>
