{% load static %}
{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{{ officer.birth_name }} - Thân nhân</title>
        {% tailwind_css %}

        <link rel="stylesheet" href="{% static 'src/styles.css' %}">

        <script>
            function confirmDelete() {
                return confirm('Are you sure you want to delete this title?');
            }
        </script>
    </head>
    <body>
        <div class="flex">
            <div class="w-1/5 bg-base-200 py-20">
                <div class="hoverable-item">
                    <a href="{% url 'officer_list' %}" class="hoverable-link">
                        <img src="{% static 'src/home-icon.png' %}" alt="Home Icon" class="w-6 h-6">
                        <span>Trang chủ</span>
                    </a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_title_view' officer.pk %}" class="hoverable-link-secondary">Chức danh</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_position_plan' officer.pk %}" class="hoverable-link-secondary">Quy hoạch</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_learning_path' officer.pk %}" class="hoverable-link-secondary">Đào tạo</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_work_process' officer.pk %}" class="hoverable-link-secondary">Quá trình công tác</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_salary_process' officer.pk %}" class="hoverable-link-secondary">Quá trình lương</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_laudatory' officer.pk %}" class="hoverable-link-secondary">Khen thưởng</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_discipline' officer.pk %}" class="hoverable-link-secondary">Kỷ luật</a>
                </div>
                <div class="highlight-item">
                    <a href="{% url 'url_relative' officer.pk %}" class="hoverable-link-secondary">Thân nhân</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_abroad' officer.pk %}" class="hoverable-link-secondary">Ra nước ngoài</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_army_join_history' officer.pk %}" class="hoverable-link-secondary">Tham gia quân đội</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_health' officer.pk %}" class="hoverable-link-secondary">Sức khoẻ</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_image' officer.pk %}" class="hoverable-link-secondary">Ảnh</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'officer_update' officer.pk %}" class="hoverable-link-secondary">Cập nhật</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'officer_detail' officer.pk %}" class="hoverable-link">
                        <img src="{% static 'src/back-icon.png' %}" alt="Back Icon" class="w-7 h-7">
                        <span>Quay lại</span>
                    </a>
                </div>
            </div>

            <div class="w-4/5 h-full mt-20 mx-10">
                <h1 class="text-4xl text-center ">Thân nhân: <strong class="ml-3">{{ officer.birth_name }}</strong></h1>

                <div class="flex justify-end mb-7 mt-10">
                    <!-- Create New Position Plan Button -->
                    <a href="{% url 'url_position_plan_create' officer.pk %}">
                        <button class="btn px-4 py-2 rounded-lg shadow-inner drop-shadow-lg inline-flex items-center text-lg z-10">
                            <span class="mr-2">Thêm mới</span>
                            <img src="{% static 'src/new-folder.png' %}" alt="New Folder" class="w-5 h-5">
                        </button>
                    </a>
                </div>
                <div>
                    <table class="table-auto border-collapse w-full text-center mb-20">
                        <thead>
                            <tr class="bg-gray-600 text-white text-xl">
                                <th class="py-2 px-4">Quan hệ</th>
                                <th class="py-2 px-4 text-left">Họ và tên</th>
                                <th class="py-2 px-4">Năm sinh</th>
                                <th class="py-2 px-4">Nghề nghiệp</th>
                                <th class="py-2 pl-28 text-left">Chỗ ở hiện nay</th>
                                <th class="py-2 px-4"></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for relative in relatives %}
                            <tr class="border-t border-gray-300 bg-gray-100 text-lg">
                                <td class="py-2 pl-4">{{ relative.relationship }}</td>
                                <td class="py-2 px-4 text-left">{{ relative.name }}</td>
                                <td class="py-2 px-4">{{ relative.birth_year }}</td>
                                <td class="py-2 px-4">{{ relative.job }}</td>
                                <td class="py-2 pl-10 text-left">{{ relative.current_residence }}</td>
                                <td class="py-2 px-4">
                                
                                    <!-- Update Button -->
                                    <a href="{% url 'url_relative_update' officer.pk relative.id %}"
                                    class="text-green-500 hover:text-green-600 underline mx-2"
                                    >
                                        Cập nhật
                                    </a>

                                    <span>/</span>

                                    <!-- Delete Button with confirmation -->
                                    <form
                                        method="POST"
                                        action="{% url 'url_relative_delete' officer.pk relative.id %}"
                                        style="display: inline"
                                        onsubmit="return confirmDelete();"
                                    >
                                        {% csrf_token %}
                                        <button type="submit" class="text-red-600 hover:text-red-700 underline mx-2">Xoá</button>
                                    </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Create or Update Relative Form -->
                {% if form %}
                <dialog class="modal" id="modal">
                    <div class="modal-box">
                        <h1 class="text-xl text-center font-semibold mb-7 ml-2">
                            {% if edit_relative_id %}Cập nhật thông tin{% else %}Thêm mới thông tin
                            {% endif %}
                        </h1>
                        <form method="dialog">
                            <a href="{% url 'url_relative' officer.pk %}" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 mr-2 mt-4">
                                <img src="{% static 'src/close.png' %}" alt="Close Form" class="w-5 h-5">
                            </a>
                        </form>

                        <form method="POST">
                            {% csrf_token %} 
                            
                            
                            <label for="relationship" class="font-semibold ml-7">Quan hệ:</label>
                            <div class="form-group mt-3 mx-5">
                                {{ form.relationship }}
                            </div>
                            
                            <label for="name" class="font-semibold ml-7">Họ và tên:</label>
                            <div class="form-group mt-3 mx-5">
                                {{ form.name }}
                            </div>
                            
                            <label for="birth_year" class="font-semibold ml-7">Năm sinh:</label>
                            <div class="form-group mt-3 mx-5">
                                {{ form.birth_year }}
                            </div>
                            
                            <label for="job" class="font-semibold ml-7">Nghề nghiệp:</label>
                            <div class="form-group mt-3 mx-5">
                                {{ form.job }}
                            </div>
                            
                            <label for="current_residence" class="font-semibold ml-7">Chỗ ở hiện nay:</label>
                            <div class="form-group mt-3 mx-5">
                                {{ form.current_residence }}
                            </div>
                            
                            <div class="modal-action">
                                <button type="submit" class="btn mr-3 rounded-lg">
                                    Lưu
                                </button>
                            </div>
                        </form>
                    </div>
                    <form method="dialog" class="modal-backdrop">
                        <a href="{% url 'url_relative' officer.pk %}">close</a>
                    </form>
                </dialog>
                {% endif %}

                <script>
                    // Automatically show the modal when the page loads
                    document.addEventListener("DOMContentLoaded", function() {
                        document.getElementById('modal').showModal();
                    });
                </script>
            </div>
        </div>
    </body>
</html>
