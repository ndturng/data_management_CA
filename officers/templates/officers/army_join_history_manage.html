{% load static %}
{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport"
              content="width=device-width, initial-scale=1.0" />
        <title>{{ officer.birth_name }} - Tham gia quân đội</title>
        {% tailwind_css %}

        <script>
            function confirmDelete() {
                return confirm('Are you sure you want to delete this title?');
            }
        </script>
    </head>
    <body>
        <div class="flex h-screen">
            <div class="w-1/5 bg-base-200 min-h-screen py-5">
                <div class="hoverable-item">
                    <a href="{% url 'officer_list' %}"
                       class="hoverable-link">
                        <img src="{% static 'src/home-icon.png' %}"
                             alt="Home Icon"
                             class="w-6 h-6" />
                        <span>Trang chủ</span>
                    </a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'officer_detail' officer.pk %}"
                       class="hoverable-link-secondary">Thông tin chung</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_title_view' officer.pk %}"
                       class="hoverable-link-secondary">Chức danh</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_position_plan' officer.pk %}"
                       class="hoverable-link-secondary">Quy hoạch</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_learning_path' officer.pk %}"
                       class="hoverable-link-secondary">Đào tạo</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_work_process' officer.pk %}"
                       class="hoverable-link-secondary">Quá trình công tác</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_salary_process' officer.pk %}"
                       class="hoverable-link-secondary">Quá trình lương</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_laudatory' officer.pk %}"
                       class="hoverable-link-secondary">Khen thưởng</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_discipline' officer.pk %}"
                       class="hoverable-link-secondary">Kỷ luật</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_relative' officer.pk %}"
                       class="hoverable-link-secondary">Thân nhân</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_abroad' officer.pk %}"
                       class="hoverable-link-secondary">Ra nước ngoài</a>
                </div>
                <div class="highlight-item">
                    <a href="{% url 'url_army_join_history' officer.pk %}"
                       class="hoverable-link-secondary">Tham gia quân đội</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_health' officer.pk %}"
                       class="hoverable-link-secondary">Sức khoẻ</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'url_image' officer.pk %}"
                       class="hoverable-link-secondary">Ảnh</a>
                </div>
                <div class="hoverable-item">
                    <a href="{% url 'officer_update' officer.pk %}"
                       class="hoverable-link-secondary">Cập nhật</a>
                </div>
            </div>

            <div class="w-4/5 h-screen overflow-y-auto px-10 pb-5 pt-16">
                <h1 class="text-4xl text-center">
                    Tham gia quân đội: <strong class="ml-3">{{ officer.birth_name }}</strong>
                </h1>

                <div class="flex justify-end mb-7 mt-10">
                    <!-- Create New Position Plan Button -->
                    <a href="{% url 'url_army_join_history_create' officer.pk %}">
                        <button class="btn px-4 py-2 rounded-lg shadow-inner drop-shadow-lg inline-flex items-center text-lg z-10">
                            <span class="mr-2">Thêm mới</span>
                            <img src="{% static 'src/new-folder.png' %}"
                                 alt="New Folder"
                                 class="w-5 h-5" />
                        </button>
                    </a>
                </div>
                <div>
                    <table class="table-auto border-collapse w-full text-center">
                        <thead>
                            <tr class="bg-gray-600 text-white text-xl">
                                <th class="py-2 px-4">Giai đoạn</th>
                                <th class="py-2 px-4">Đơn vị</th>
                                <th class="py-2 px-4">Hình thức</th>
                                <th class="py-2 px-4"></th>
                            </tr>
                        </thead>
                        <tbody>

                            {% for army_join in army_join_histories %}
                                <tr class="border-t border-gray-300 bg-gray-100 text-lg">
                                    <td class="py-2 px-4">{{ army_join.period }}</td>
                                    <td class="py-2 px-4">{{ army_join.unit }}</td>
                                    <td class="py-2 px-4">{{ army_join.form }}</td>
                                    <td class="py-2">
                                        <div class="flex items-center space-x-7">
                                            <!-- Update Button -->
                                            <div class="flex-none tooltip tooltip-top"
                                                 data-tip="Cập nhật">
                                                <a href="{% url 'url_army_join_history_update' officer.pk army_join.id %}">
                                                    <button class="transform motion-safe:hover:scale-110">
                                                        <img src="{% static 'src/update-icon.png' %}"
                                                             alt="Update icon"
                                                             class="w-7 h-7" />
                                                    </button>
                                                </a>
                                            </div>

                                            <!-- Delete Button with confirmation -->
                                            <div class="flex-none tooltip tooltip-top"
                                                 data-tip="Xoá">
                                                <form method="POST"
                                                      action="{% url 'url_army_join_history_delete' officer.pk army_join.id %}"
                                                      onsubmit="return confirmDelete();">
                                                    {% csrf_token %}
                                                    <button type="submit"
                                                            class="transform motion-safe:hover:scale-110">
                                                        <img src="{% static 'src/delete-icon.png' %}"
                                                             alt="Delete icon"
                                                             class="w-6 h-6" />
                                                    </button>
                                                </form>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}

                        </tbody>
                    </table>
                </div>

                <!-- Create or Update Army Join History Form -->

                {% if form %}
                    <dialog class="modal"
                            id="modal">
                        <div class="modal-box">
                            <h1 class="text-xl text-center font-semibold mb-7 ml-2">

                                {% if edit_army_join_history_id %}
                                    Cập nhật thông tin
                                {% else %}
                                    Thêm mới thông tin
                                {% endif %}

                            </h1>
                            <form method="dialog">
                                <a href="{% url 'url_army_join_history' officer.pk %}"
                                   class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 mr-5 mt-4">
                                    <img src="{% static 'src/close.png' %}"
                                         alt="Close Form"
                                         class="w-5 h-5" />
                                </a>
                            </form>

                            <form method="POST">
                                {% csrf_token %}

                                <label for="id_period"
                                       class="font-semibold ml-7">
                                    Giai đoạn:
                                </label>
                                <div class="form-group mt-3 mx-5">{{ form.period }}</div>

                                <label for="id_unit"
                                       class="font-semibold ml-7">
                                    Đơn vị:
                                </label>
                                <div class="form-group mt-3 mx-5">{{ form.unit }}</div>

                                <label for="id_form"
                                       class="font-semibold ml-7">
                                    Hình thức:
                                </label>
                                <div class="form-group mt-3 mx-5">{{ form.form }}</div>

                                <div class="modal-action">
                                    <button type="submit"
                                            class="btn mr-3 rounded-lg">
                                        Lưu
                                    </button>
                                </div>
                            </form>
                        </div>
                        <form method="dialog"
                              class="modal-backdrop">
                            <a href="{% url 'url_army_join_history' officer.pk %}">close</a>
                        </form>
                    </dialog>
                {% endif %}


                <script>
                    // Automatically show the modal when the page loads
                    document.addEventListener("DOMContentLoaded", function() {
                        document.getElementById('modal').showModal();
                    });
                </script>
            </div>
        </div>
    </body>
</html>
